version: "3.8"

services:
  evc-monitor:
    build: .
    image: evc-charger-monitor:latest
    container_name: evc-charger-monitor
    restart: unless-stopped
    ports:
      - "5000:5000"
    environment:
      # REQUIRED: Set your charging station QR codes
      # Format: QR_CODE:Name,QR_CODE:Name
      # Example: GRDR-0123*1:Station 1,GRDR-0124*1:Station 2
      - STATIONS=${STATIONS:-GRDR-0123*1:Station 1,GRDR-0124*1:Station 2}
      
      # Optional settings
      - TZ=${TZ:-Europe/Amsterdam}
      - PORT=${PORT:-5000}
      - REFRESH_INTERVAL=${REFRESH_INTERVAL:-300}
    healthcheck:
      test: ["CMD", "python", "-c", "import requests; r=requests.get('http://localhost:5000/health', timeout=5); exit(0 if r.ok else 1)"]
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 30s
    labels:
      - "com.centurylinklabs.watchtower.enable=true"
